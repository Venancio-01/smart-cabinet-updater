# 智能载体管控系统更新程序使用说明

## 项目简介

这是一个用于智能载体管控系统的更新程序，主要用于更新载体柜、后台系统和通道门等组件的软件。该程序通过 SSH 协议实现远程文件传输和更新。

## 系统要求

- 操作系统：Windows

## 配置说明

程序使用以下默认配置：

### 载体柜配置

```json
{
  "host": "liqingshan@192.168.70.143",
  "port": 22,
  "uploadPath": "/home/liqingshan/smart-cabinet"
}
```

### 服务器配置

```json
{
  "host": "root@192.168.1.50",
  "port": 22,
  "uploadPath": "/opt/hjrich/smart-cabinet/cabinet-server-update",
  "targetPath": "/opt/hjrich/cabinet-server"
}
```

```json
{
  "backendFolderPath": "后台更新程序",
  "cabinetFolderPath": "载体柜更新程序",
  "doorFolderPath": "通道门更新程序",
  "backgroundFolderPath": "载体柜程序背景图片"
}
```

## 使用方法

### 运行程序

- 双击运行 `智能载体管控系统更新程序.exe`，或在命令行中执行以下命令：

  ```bash
  ./智能载体管控系统更新程序.exe
  ```

### 功能选择

程序启动后，会**自动检测可用的更新选项**，并显示如下菜单：

1. 更新后台程序
   - 需要输入服务器管理员密码
   - 会自动停止 Cabinet 服务
   - 完成后自动重启服务
   - 更新完成后会验证服务状态

2. 更新载体柜程序
   - 需要输入载体柜管理员密码
   - 会自动停止载体柜程序和指纹进程
   - 更新完成后会自动重启设备
   - 包含指纹服务权限配置

3. 更新通道门程序
   - 需要输入通道门管理员密码
   - 会自动停止通道门程序和摄像头进程
   - 更新完成后会自动重启设备

### 更新流程

1. 选择更新选项
   - 输入对应的数字（1-3）选择要执行的操作
   - 程序会自动检查相应文件夹是否存在更新文件

2. 输入密码
   - 根据提示输入对应设备的管理员密码
   - 密码输入时不会显示在屏幕上

3. 更新过程
   - 程序会自动上传更新文件
   - 执行更新操作
   - 验证文件完整性
   - 重启相关服务或设备

4. 完成确认
   - 更新完成后会显示成功提示
   - 对于需要重启的设备，会在2秒后自动重启

### 退出程序

- 在任何时候按 `Ctrl+C` 或 `ESC` 键可以安全退出程序
- 程序会自动清理临时文件和连接

## 注意事项

1. 使用前请确保配置文件中的 IP 地址和端口号正确
2. 确保有足够的权限访问目标设备
3. 建议在更新前备份重要数据
4. 更新过程中请勿关闭程序

## 目录结构

程序运行需要以下文件结构：

```
智能载体管控系统更新程序/
├── 智能载体管控系统更新程序.exe  # 主程序
├── 后台更新程序/                # 存放后台程序更新文件
├── 载体柜更新程序/              # 存放载体柜程序更新文件
└── 通道门更新程序/              # 存放通道门程序更新文件
```

将需要更新的文件放入对应的文件夹中，程序会自动识别并进行更新。
